22/02/15 09:13:41 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
22/02/15 09:13:55 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
22/02/15 09:14:51 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[Stage 0:>                                                          (0 + 8) / 8][Stage 0:>                  (0 + 8) / 8][Stage 1:>                  (0 + 0) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 1:>                                                          (0 + 1) / 1][Stage 2:>                                                        (0 + 8) / 200][Stage 2:=>                                                       (6 + 9) / 200][Stage 2:==>                                                      (8 + 8) / 200][Stage 2:===>                                                    (11 + 9) / 200][Stage 2:===>                                                    (14 + 8) / 200][Stage 2:====>                                                   (16 + 8) / 200][Stage 2:=====>                                                  (18 + 9) / 200][Stage 2:=====>                                                  (20 + 8) / 200][Stage 2:======>                                                 (24 + 8) / 200][Stage 2:=======>                                                (26 + 8) / 200][Stage 2:========>                                               (30 + 8) / 200][Stage 2:========>                                               (31 + 8) / 200][Stage 2:=========>                                              (34 + 8) / 200][Stage 2:==========>                                             (39 + 8) / 200][Stage 2:===========>                                            (42 + 8) / 200][Stage 2:============>                                           (46 + 8) / 200][Stage 2:=============>                                          (49 + 8) / 200][Stage 2:==============>                                         (53 + 8) / 200][Stage 2:===============>                                        (56 + 8) / 200][Stage 2:================>                                       (58 + 9) / 200][Stage 2:=================>                                      (62 + 8) / 200][Stage 2:==================>                                     (66 + 8) / 200][Stage 2:===================>                                    (69 + 9) / 200][Stage 2:====================>                                   (73 + 9) / 200][Stage 2:=====================>                                  (78 + 8) / 200][Stage 2:======================>                                 (80 + 8) / 200][Stage 2:=======================>                                (84 + 9) / 200][Stage 2:=========================>                              (90 + 8) / 200][Stage 2:=========================>                              (91 + 8) / 200][Stage 2:===========================>                            (98 + 8) / 200][Stage 2:===========================>                          (101 + 10) / 200][Stage 2:============================>                          (105 + 8) / 200][Stage 2:==============================>                        (110 + 8) / 200][Stage 2:==============================>                        (112 + 8) / 200][Stage 2:================================>                      (119 + 8) / 200][Stage 2:=================================>                     (121 + 8) / 200][Stage 2:==================================>                    (124 + 9) / 200][Stage 2:===================================>                   (129 + 8) / 200][Stage 2:=====================================>                 (136 + 8) / 200][Stage 2:=====================================>                 (138 + 8) / 200][Stage 2:=======================================>               (144 + 8) / 200][Stage 2:========================================>              (146 + 8) / 200][Stage 2:=========================================>             (150 + 8) / 200][Stage 2:==========================================>            (154 + 8) / 200][Stage 2:===========================================>           (157 + 8) / 200][Stage 2:============================================>          (162 + 8) / 200][Stage 2:============================================>          (163 + 9) / 200][Stage 2:==============================================>        (169 + 8) / 200][Stage 2:===============================================>       (171 + 8) / 200][Stage 2:================================================>      (175 + 8) / 200][Stage 2:=================================================>     (179 + 8) / 200][Stage 2:==================================================>    (183 + 8) / 200][Stage 2:===================================================>   (186 + 8) / 200][Stage 2:====================================================>  (191 + 8) / 200][Stage 2:=====================================================> (195 + 5) / 200]                                                                                [Stage 3:>                  (0 + 1) / 1][Stage 4:>                  (0 + 7) / 8][Stage 3:>                  (0 + 1) / 1][Stage 4:====>              (2 + 6) / 8][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 3:>                                                          (0 + 1) / 1][Stage 5:=>                                                       (4 + 8) / 200][Stage 5:==>                                                      (8 + 8) / 200][Stage 5:==>                                                     (10 + 8) / 200][Stage 5:====>                                                   (15 + 8) / 200][Stage 5:====>                                                   (16 + 8) / 200][Stage 5:=====>                                                  (20 + 8) / 200][Stage 5:======>                                                 (23 + 8) / 200][Stage 5:=======>                                                (27 + 9) / 200][Stage 5:========>                                               (32 + 8) / 200][Stage 5:=========>                                              (35 + 8) / 200][Stage 5:==========>                                             (39 + 8) / 200][Stage 5:============>                                           (43 + 8) / 200][Stage 5:=============>                                          (47 + 8) / 200][Stage 5:==============>                                         (50 + 8) / 200][Stage 5:===============>                                        (55 + 8) / 200][Stage 5:================>                                       (58 + 8) / 200][Stage 5:=================>                                      (63 + 8) / 200][Stage 5:=================>                                      (64 + 8) / 200][Stage 5:===================>                                    (69 + 9) / 200][Stage 5:====================>                                   (73 + 8) / 200][Stage 5:=====================>                                  (77 + 8) / 200][Stage 5:======================>                                 (81 + 9) / 200][Stage 5:=======================>                                (83 + 9) / 200][Stage 5:========================>                               (88 + 8) / 200][Stage 5:=========================>                              (91 + 8) / 200][Stage 5:==========================>                             (95 + 8) / 200][Stage 5:===========================>                            (98 + 8) / 200][Stage 5:============================>                          (102 + 8) / 200][Stage 5:=============================>                         (106 + 8) / 200][Stage 5:==============================>                        (111 + 8) / 200][Stage 5:===============================>                       (113 + 8) / 200][Stage 5:================================>                      (118 + 8) / 200][Stage 5:=================================>                     (120 + 8) / 200][Stage 5:==================================>                    (125 + 8) / 200][Stage 5:===================================>                   (128 + 8) / 200][Stage 5:====================================>                  (133 + 8) / 200][Stage 5:=====================================>                 (135 + 8) / 200][Stage 5:======================================>                (141 + 8) / 200][Stage 5:========================================>              (146 + 8) / 200][Stage 5:========================================>              (149 + 8) / 200][Stage 5:==========================================>            (154 + 8) / 200][Stage 5:===========================================>           (157 + 8) / 200][Stage 5:============================================>          (161 + 9) / 200][Stage 5:=============================================>         (165 + 8) / 200][Stage 5:==============================================>        (168 + 9) / 200][Stage 5:===============================================>       (172 + 8) / 200][Stage 5:================================================>      (176 + 8) / 200][Stage 5:=================================================>     (180 + 8) / 200][Stage 5:==================================================>    (184 + 9) / 200][Stage 5:===================================================>   (187 + 8) / 200][Stage 5:====================================================>  (191 + 8) / 200][Stage 5:=====================================================> (194 + 6) / 200][Stage 5:======================================================>(199 + 1) / 200]                                                                                [Stage 6:>                  (0 + 1) / 1][Stage 7:==>                (1 + 7) / 8][Stage 6:>                  (0 + 1) / 1][Stage 7:================>  (7 + 1) / 8][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 6:>                                                          (0 + 1) / 1][Stage 8:=>                                                       (4 + 8) / 200][Stage 8:=>                                                       (7 + 8) / 200][Stage 8:==>                                                     (10 + 8) / 200][Stage 8:===>                                                    (13 + 8) / 200][Stage 8:====>                                                   (16 + 8) / 200][Stage 8:=====>                                                  (18 + 8) / 200][Stage 8:======>                                                 (22 + 8) / 200][Stage 8:======>                                                 (24 + 8) / 200][Stage 8:========>                                               (29 + 8) / 200][Stage 8:========>                                               (30 + 8) / 200][Stage 8:=========>                                              (35 + 8) / 200][Stage 8:==========>                                             (37 + 8) / 200][Stage 8:==========>                                             (38 + 9) / 200][Stage 8:============>                                           (43 + 8) / 200][Stage 8:============>                                           (45 + 8) / 200][Stage 8:=============>                                          (49 + 8) / 200][Stage 8:===============>                                        (54 + 8) / 200][Stage 8:===============>                                        (54 + 9) / 200][Stage 8:================>                                       (58 + 8) / 200][Stage 8:=================>                                      (61 + 8) / 200][Stage 8:=================>                                      (62 + 9) / 200][Stage 8:===================>                                    (68 + 8) / 200][Stage 8:===================>                                    (70 + 8) / 200][Stage 8:===================>                                    (71 + 8) / 200][Stage 8:=====================>                                  (75 + 8) / 200][Stage 8:=====================>                                  (76 + 8) / 200][Stage 8:======================>                                 (80 + 8) / 200][Stage 8:======================>                                 (81 + 9) / 200][Stage 8:=======================>                                (83 + 8) / 200][Stage 8:=======================>                                (84 + 8) / 200][Stage 8:========================>                               (89 + 9) / 200][Stage 8:=========================>                              (92 + 8) / 200][Stage 8:==========================>                             (93 + 9) / 200][Stage 8:===========================>                            (98 + 8) / 200][Stage 8:===========================>                            (99 + 8) / 200][Stage 8:============================>                          (103 + 8) / 200][Stage 8:============================>                          (105 + 8) / 200][Stage 8:==============================>                        (110 + 8) / 200][Stage 8:==============================>                        (112 + 8) / 200][Stage 8:===============================>                       (114 + 8) / 200][Stage 8:================================>                      (118 + 8) / 200][Stage 8:=================================>                     (121 + 8) / 200][Stage 8:==================================>                    (124 + 8) / 200][Stage 8:==================================>                    (127 + 8) / 200][Stage 8:===================================>                   (129 + 8) / 200][Stage 8:====================================>                  (132 + 8) / 200][Stage 8:=====================================>                 (137 + 8) / 200][Stage 8:=====================================>                 (138 + 8) / 200][Stage 8:======================================>                (141 + 8) / 200][Stage 8:=======================================>               (145 + 8) / 200][Stage 8:========================================>              (147 + 8) / 200][Stage 8:=========================================>             (150 + 8) / 200][Stage 8:==========================================>            (153 + 8) / 200][Stage 8:==========================================>            (156 + 8) / 200][Stage 8:===========================================>           (158 + 8) / 200][Stage 8:============================================>          (161 + 8) / 200][Stage 8:=============================================>         (164 + 8) / 200][Stage 8:=============================================>         (166 + 8) / 200][Stage 8:=============================================>         (167 + 9) / 200][Stage 8:==============================================>        (169 + 8) / 200][Stage 8:===============================================>       (173 + 8) / 200][Stage 8:===============================================>       (174 + 8) / 200][Stage 8:================================================>      (176 + 8) / 200][Stage 8:=================================================>     (181 + 8) / 200][Stage 8:==================================================>    (182 + 8) / 200][Stage 8:==================================================>    (183 + 8) / 200][Stage 8:===================================================>   (186 + 8) / 200][Stage 8:====================================================>  (191 + 8) / 200][Stage 8:=====================================================> (193 + 7) / 200][Stage 8:=====================================================> (196 + 4) / 200]                                                                                [Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 9:>                                                          (0 + 1) / 1][Stage 11:=>                                                      (6 + 8) / 200][Stage 11:==>                                                     (9 + 8) / 200][Stage 11:===>                                                   (12 + 9) / 200][Stage 11:====>                                                  (17 + 8) / 200][Stage 11:======>                                                (22 + 8) / 200][Stage 11:=======>                                               (27 + 8) / 200][Stage 11:========>                                              (31 + 8) / 200][Stage 11:=========>                                             (36 + 8) / 200][Stage 11:===========>                                           (41 + 8) / 200][Stage 11:============>                                          (45 + 8) / 200][Stage 11:=============>                                         (50 + 8) / 200][Stage 11:==============>                                        (54 + 9) / 200][Stage 11:===============>                                       (58 + 8) / 200][Stage 11:=================>                                     (62 + 8) / 200][Stage 11:==================>                                    (68 + 8) / 200][Stage 11:===================>                                   (71 + 8) / 200][Stage 11:====================>                                  (75 + 8) / 200][Stage 11:=====================>                                 (79 + 8) / 200][Stage 11:======================>                                (83 + 8) / 200][Stage 11:=======================>                               (87 + 8) / 200][Stage 11:=========================>                             (92 + 8) / 200][Stage 11:==========================>                            (96 + 8) / 200][Stage 11:===========================>                          (101 + 8) / 200][Stage 11:===========================>                          (103 + 9) / 200][Stage 11:=============================>                        (109 + 8) / 200][Stage 11:==============================>                       (113 + 8) / 200][Stage 11:===============================>                      (117 + 8) / 200][Stage 11:================================>                     (122 + 8) / 200][Stage 11:==================================>                   (126 + 8) / 200][Stage 11:==================================>                   (129 + 8) / 200][Stage 11:====================================>                 (134 + 8) / 200][Stage 11:====================================>                 (135 + 9) / 200][Stage 11:======================================>               (142 + 8) / 200][Stage 11:=======================================>              (145 + 8) / 200][Stage 11:========================================>             (151 + 8) / 200][Stage 11:=========================================>            (154 + 8) / 200][Stage 11:==========================================>           (158 + 9) / 200][Stage 11:============================================>         (163 + 8) / 200][Stage 11:============================================>         (165 + 8) / 200][Stage 11:=============================================>        (169 + 8) / 200][Stage 11:==============================================>       (172 + 8) / 200][Stage 11:==============================================>      (176 + 10) / 200][Stage 11:================================================>     (180 + 8) / 200][Stage 11:=================================================>    (185 + 8) / 200][Stage 11:==================================================>   (188 + 8) / 200][Stage 11:====================================================> (194 + 6) / 200][Stage 11:=====================================================>(199 + 1) / 200]                                                                                [Stage 12:>                 (0 + 1) / 1][Stage 13:>                 (0 + 7) / 8][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 12:>                                                         (0 + 1) / 1][Stage 14:=>                                                      (7 + 8) / 200][Stage 14:==>                                                     (9 + 8) / 200][Stage 14:===>                                                   (14 + 8) / 200][Stage 14:====>                                                  (16 + 8) / 200][Stage 14:=====>                                                 (21 + 8) / 200][Stage 14:=====>                                                (22 + 10) / 200][Stage 14:======>                                                (25 + 8) / 200][Stage 14:========>                                              (31 + 8) / 200][Stage 14:=========>                                             (36 + 8) / 200][Stage 14:===========>                                           (40 + 8) / 200][Stage 14:===========>                                           (42 + 9) / 200][Stage 14:============>                                          (46 + 8) / 200][Stage 14:=============>                                         (50 + 8) / 200][Stage 14:==============>                                        (52 + 9) / 200][Stage 14:===============>                                       (55 + 8) / 200][Stage 14:================>                                      (59 + 8) / 200][Stage 14:=================>                                     (62 + 8) / 200][Stage 14:=================>                                     (65 + 9) / 200][Stage 14:==================>                                    (69 + 8) / 200][Stage 14:===================>                                   (70 + 9) / 200][Stage 14:====================>                                  (73 + 8) / 200][Stage 14:=====================>                                 (78 + 8) / 200][Stage 14:======================>                                (80 + 9) / 200][Stage 14:======================>                                (83 + 8) / 200][Stage 14:=======================>                               (86 + 8) / 200][Stage 14:========================>                              (90 + 8) / 200][Stage 14:=========================>                             (92 + 9) / 200][Stage 14:==========================>                            (96 + 8) / 200][Stage 14:===========================>                          (100 + 8) / 200][Stage 14:===========================>                          (103 + 8) / 200][Stage 14:============================>                         (107 + 8) / 200][Stage 14:=============================>                        (109 + 9) / 200][Stage 14:==============================>                       (114 + 8) / 200][Stage 14:===============================>                      (115 + 8) / 200][Stage 14:===============================>                      (118 + 8) / 200][Stage 14:================================>                     (122 + 8) / 200][Stage 14:=================================>                    (125 + 8) / 200][Stage 14:===================================>                  (130 + 8) / 200][Stage 14:===================================>                  (133 + 8) / 200][Stage 14:====================================>                 (136 + 8) / 200][Stage 14:=====================================>                (139 + 8) / 200][Stage 14:======================================>               (143 + 8) / 200][Stage 14:=======================================>              (147 + 8) / 200][Stage 14:========================================>             (150 + 8) / 200][Stage 14:=========================================>            (152 + 8) / 200][Stage 14:==========================================>           (156 + 8) / 200][Stage 14:===========================================>          (160 + 9) / 200][Stage 14:============================================>         (163 + 8) / 200][Stage 14:=============================================>        (167 + 8) / 200][Stage 14:=============================================>        (170 + 8) / 200][Stage 14:==============================================>       (171 + 8) / 200][Stage 14:==============================================>       (173 + 8) / 200][Stage 14:===============================================>      (177 + 8) / 200][Stage 14:================================================>     (179 + 8) / 200][Stage 14:================================================>     (180 + 8) / 200][Stage 14:================================================>     (181 + 8) / 200][Stage 14:==================================================>   (186 + 8) / 200][Stage 14:==================================================>   (188 + 8) / 200][Stage 14:===================================================>  (189 + 8) / 200][Stage 14:====================================================> (193 + 7) / 200][Stage 14:=====================================================>(197 + 3) / 200]                                                                                [Stage 16:>                                                         (0 + 1) / 1][Stage 16:>                                                         (0 + 1) / 1][Stage 16:>                                                         (0 + 1) / 1][Stage 16:>                                                         (0 + 1) / 1][Stage 16:>                                                         (0 + 1) / 1][Stage 16:>                                                         (0 + 1) / 1][Stage 16:>                                                         (0 + 1) / 1][Stage 17:=>                                                      (5 + 8) / 200][Stage 17:=>                                                      (7 + 8) / 200][Stage 17:==>                                                     (9 + 8) / 200][Stage 17:===>                                                   (14 + 8) / 200][Stage 17:====>                                                  (16 + 8) / 200][Stage 17:=====>                                                 (20 + 8) / 200][Stage 17:======>                                                (24 + 8) / 200][Stage 17:=======>                                               (26 + 9) / 200][Stage 17:========>                                              (31 + 9) / 200][Stage 17:=========>                                             (34 + 8) / 200][Stage 17:==========>                                            (39 + 9) / 200][Stage 17:===========>                                           (42 + 8) / 200][Stage 17:============>                                          (47 + 8) / 200][Stage 17:=============>                                         (49 + 8) / 200][Stage 17:==============>                                        (53 + 8) / 200][Stage 17:===============>                                       (57 + 8) / 200][Stage 17:================>                                      (60 + 9) / 200][Stage 17:=================>                                     (64 + 8) / 200][Stage 17:==================>                                    (69 + 9) / 200][Stage 17:====================>                                  (74 + 8) / 200][Stage 17:=====================>                                 (77 + 8) / 200][Stage 17:======================>                                (81 + 8) / 200][Stage 17:=======================>                               (85 + 8) / 200][Stage 17:========================>                              (88 + 8) / 200][Stage 17:=========================>                             (91 + 8) / 200][Stage 17:==========================>                            (95 + 8) / 200][Stage 17:==========================>                            (98 + 8) / 200][Stage 17:===========================>                          (102 + 8) / 200][Stage 17:============================>                         (104 + 8) / 200][Stage 17:=============================>                        (108 + 8) / 200][Stage 17:=============================>                        (110 + 8) / 200][Stage 17:==============================>                       (114 + 8) / 200][Stage 17:===============================>                      (115 + 8) / 200][Stage 17:===============================>                      (117 + 8) / 200][Stage 17:=================================>                    (123 + 8) / 200][Stage 17:==================================>                   (126 + 8) / 200][Stage 17:==================================>                   (127 + 8) / 200][Stage 17:===================================>                  (132 + 8) / 200][Stage 17:====================================>                 (135 + 8) / 200][Stage 17:====================================>                 (137 + 8) / 200][Stage 17:======================================>               (142 + 8) / 200][Stage 17:=======================================>              (146 + 8) / 200][Stage 17:========================================>             (151 + 8) / 200][Stage 17:==========================================>           (156 + 8) / 200][Stage 17:==========================================>           (158 + 8) / 200][Stage 17:============================================>         (163 + 8) / 200][Stage 17:=============================================>        (167 + 8) / 200][Stage 17:=============================================>        (170 + 8) / 200][Stage 17:==============================================>       (173 + 8) / 200][Stage 17:================================================>     (178 + 8) / 200][Stage 17:================================================>     (181 + 8) / 200][Stage 17:=================================================>    (183 + 8) / 200][Stage 17:===================================================>  (190 + 8) / 200][Stage 17:===================================================>  (191 + 8) / 200][Stage 17:=====================================================>(197 + 3) / 200]                                                                                [Stage 18:>                 (0 + 8) / 8][Stage 19:>                 (0 + 0) / 1][Stage 18:==>               (1 + 7) / 8][Stage 19:>                 (0 + 1) / 1][Stage 19:>                                                         (0 + 1) / 1][Stage 19:>                                                         (0 + 1) / 1][Stage 19:>                                                         (0 + 1) / 1][Stage 19:>                                                         (0 + 1) / 1][Stage 19:>                                                         (0 + 1) / 1][Stage 19:>                                                         (0 + 1) / 1][Stage 19:>                                                         (0 + 1) / 1][Stage 19:>                                                         (0 + 1) / 1][Stage 20:==>                                                     (8 + 8) / 200][Stage 20:===>                                                   (12 + 9) / 200][Stage 20:====>                                                  (16 + 8) / 200][Stage 20:=====>                                                 (19 + 9) / 200][Stage 20:======>                                                (24 + 8) / 200][Stage 20:=======>                                               (27 + 8) / 200][Stage 20:========>                                              (32 + 8) / 200][Stage 20:=========>                                             (34 + 8) / 200][Stage 20:==========>                                            (39 + 8) / 200][Stage 20:===========>                                           (41 + 8) / 200][Stage 20:============>                                          (46 + 8) / 200][Stage 20:=============>                                         (49 + 8) / 200][Stage 20:==============>                                        (53 + 9) / 200][Stage 20:===============>                                       (56 + 8) / 200][Stage 20:=================>                                     (62 + 8) / 200][Stage 20:=================>                                     (63 + 8) / 200][Stage 20:==================>                                    (67 + 8) / 200][Stage 20:===================>                                   (71 + 8) / 200][Stage 20:====================>                                  (75 + 8) / 200][Stage 20:====================>                                  (76 + 8) / 200][Stage 20:=====================>                                 (79 + 8) / 200][Stage 20:======================>                                (81 + 9) / 200][Stage 20:======================>                                (83 + 8) / 200][Stage 20:=======================>                               (87 + 8) / 200][Stage 20:========================>                              (90 + 8) / 200][Stage 20:=========================>                             (91 + 9) / 200][Stage 20:=========================>                             (94 + 8) / 200][Stage 20:===========================>                           (99 + 8) / 200][Stage 20:===========================>                          (100 + 8) / 200][Stage 20:===========================>                          (103 + 8) / 200][Stage 20:============================>                         (106 + 8) / 200][Stage 20:============================>                         (107 + 8) / 200][Stage 20:=============================>                        (111 + 8) / 200][Stage 20:==============================>                       (113 + 8) / 200][Stage 20:===============================>                      (116 + 8) / 200][Stage 20:================================>                     (119 + 8) / 200][Stage 20:================================>                     (121 + 8) / 200][Stage 20:=================================>                    (125 + 8) / 200][Stage 20:==================================>                   (128 + 8) / 200][Stage 20:====================================>                 (134 + 8) / 200][Stage 20:====================================>                 (136 + 8) / 200][Stage 20:======================================>               (141 + 8) / 200][Stage 20:======================================>               (143 + 8) / 200][Stage 20:=======================================>              (146 + 9) / 200][Stage 20:========================================>             (150 + 8) / 200][Stage 20:=========================================>            (153 + 8) / 200][Stage 20:==========================================>           (158 + 8) / 200][Stage 20:===========================================>          (161 + 8) / 200][Stage 20:============================================>         (165 + 8) / 200][Stage 20:=============================================>        (168 + 8) / 200][Stage 20:==============================================>       (172 + 8) / 200][Stage 20:===============================================>      (176 + 8) / 200][Stage 20:================================================>     (179 + 8) / 200][Stage 20:=================================================>    (183 + 8) / 200][Stage 20:==================================================>   (186 + 8) / 200][Stage 20:===================================================>  (189 + 8) / 200][Stage 20:====================================================> (193 + 7) / 200][Stage 20:=====================================================>(197 + 3) / 200]                                                                                [Stage 21:>                 (0 + 1) / 1][Stage 22:=========>        (4 + 4) / 8][Stage 21:>                                                         (0 + 1) / 1][Stage 21:>                                                         (0 + 1) / 1][Stage 21:>                                                         (0 + 1) / 1][Stage 21:>                                                         (0 + 1) / 1][Stage 21:>                                                         (0 + 1) / 1][Stage 21:>                                                         (0 + 1) / 1][Stage 21:>                                                         (0 + 1) / 1][Stage 23:=>                                                      (6 + 8) / 200][Stage 23:==>                                                     (8 + 8) / 200][Stage 23:===>                                                   (11 + 8) / 200][Stage 23:====>                                                  (16 + 8) / 200][Stage 23:====>                                                  (18 + 8) / 200][Stage 23:======>                                                (23 + 8) / 200][Stage 23:======>                                                (25 + 8) / 200][Stage 23:========>                                              (31 + 8) / 200][Stage 23:========>                                              (32 + 8) / 200][Stage 23:=========>                                             (35 + 8) / 200][Stage 23:==========>                                            (39 + 8) / 200][Stage 23:===========>                                           (43 + 8) / 200][Stage 23:============>                                          (46 + 8) / 200][Stage 23:=============>                                         (50 + 8) / 200][Stage 23:==============>                                        (53 + 8) / 200][Stage 23:===============>                                       (57 + 8) / 200][Stage 23:================>                                      (60 + 8) / 200][Stage 23:=================>                                    (63 + 10) / 200][Stage 23:==================>                                    (68 + 8) / 200][Stage 23:===================>                                   (71 + 8) / 200][Stage 23:====================>                                  (75 + 8) / 200][Stage 23:=====================>                                 (78 + 8) / 200][Stage 23:=======================>                               (84 + 8) / 200][Stage 23:=======================>                               (86 + 8) / 200][Stage 23:=========================>                             (91 + 8) / 200][Stage 23:=========================>                             (94 + 8) / 200][Stage 23:===========================>                           (99 + 8) / 200][Stage 23:===========================>                          (100 + 8) / 200][Stage 23:============================>                         (106 + 8) / 200][Stage 23:=============================>                        (108 + 8) / 200][Stage 23:=============================>                        (110 + 8) / 200][Stage 23:==============================>                       (114 + 8) / 200][Stage 23:===============================>                      (117 + 8) / 200][Stage 23:================================>                     (122 + 8) / 200][Stage 23:==================================>                   (127 + 8) / 200][Stage 23:===================================>                  (130 + 8) / 200][Stage 23:===================================>                  (133 + 8) / 200][Stage 23:====================================>                 (137 + 8) / 200][Stage 23:======================================>               (141 + 8) / 200][Stage 23:======================================>               (143 + 8) / 200][Stage 23:=======================================>              (147 + 8) / 200][Stage 23:========================================>             (151 + 9) / 200][Stage 23:=========================================>            (154 + 8) / 200][Stage 23:==========================================>           (158 + 8) / 200][Stage 23:============================================>         (163 + 8) / 200][Stage 23:=============================================>        (167 + 8) / 200][Stage 23:=============================================>        (170 + 8) / 200][Stage 23:==============================================>       (174 + 8) / 200][Stage 23:===============================================>      (177 + 8) / 200][Stage 23:=================================================>    (182 + 8) / 200][Stage 23:=================================================>    (185 + 8) / 200][Stage 23:===================================================>  (190 + 8) / 200][Stage 23:===================================================>  (192 + 8) / 200][Stage 23:====================================================> (194 + 6) / 200][Stage 23:=====================================================>(199 + 1) / 200]                                                                                [Stage 24:>                 (0 + 1) / 1][Stage 25:>                 (0 + 7) / 8][Stage 24:>                 (0 + 1) / 1][Stage 25:==>               (1 + 7) / 8][Stage 24:>                                                         (0 + 1) / 1][Stage 24:>                                                         (0 + 1) / 1][Stage 24:>                                                         (0 + 1) / 1][Stage 24:>                                                         (0 + 1) / 1][Stage 24:>                                                         (0 + 1) / 1][Stage 24:>                                                         (0 + 1) / 1][Stage 24:>                                                         (0 + 1) / 1][Stage 26:=>                                                      (6 + 8) / 200][Stage 26:==>                                                     (8 + 8) / 200][Stage 26:==>                                                    (10 + 8) / 200][Stage 26:===>                                                   (14 + 8) / 200][Stage 26:====>                                                  (17 + 8) / 200][Stage 26:====>                                                  (18 + 8) / 200][Stage 26:=====>                                                 (21 + 8) / 200][Stage 26:======>                                                (25 + 8) / 200][Stage 26:=======>                                               (29 + 8) / 200][Stage 26:=========>                                             (34 + 8) / 200][Stage 26:=========>                                             (36 + 8) / 200][Stage 26:==========>                                            (39 + 8) / 200][Stage 26:===========>                                           (43 + 8) / 200][Stage 26:============>                                          (46 + 8) / 200][Stage 26:==============>                                        (51 + 8) / 200][Stage 26:==============>                                        (53 + 8) / 200][Stage 26:===============>                                       (57 + 8) / 200][Stage 26:================>                                      (60 + 8) / 200][Stage 26:=================>                                     (63 + 8) / 200][Stage 26:==================>                                    (67 + 8) / 200][Stage 26:===================>                                   (70 + 8) / 200][Stage 26:===================>                                   (72 + 9) / 200][Stage 26:=====================>                                 (77 + 8) / 200][Stage 26:======================>                                (81 + 8) / 200][Stage 26:=======================>                               (84 + 8) / 200][Stage 26:=======================>                               (86 + 8) / 200][Stage 26:=========================>                             (91 + 9) / 200][Stage 26:=========================>                             (94 + 8) / 200][Stage 26:==========================>                            (98 + 9) / 200][Stage 26:===========================>                          (101 + 9) / 200][Stage 26:============================>                         (105 + 8) / 200][Stage 26:=============================>                        (109 + 8) / 200][Stage 26:==============================>                       (113 + 8) / 200][Stage 26:===============================>                      (117 + 8) / 200][Stage 26:================================>                     (120 + 8) / 200][Stage 26:=================================>                    (123 + 8) / 200][Stage 26:==================================>                   (128 + 8) / 200][Stage 26:===================================>                  (130 + 8) / 200][Stage 26:====================================>                 (134 + 8) / 200][Stage 26:=====================================>                (138 + 8) / 200][Stage 26:======================================>               (141 + 8) / 200][Stage 26:=======================================>              (146 + 8) / 200][Stage 26:========================================>             (150 + 8) / 200][Stage 26:=========================================>            (153 + 8) / 200][Stage 26:==========================================>           (158 + 8) / 200][Stage 26:===========================================>          (161 + 8) / 200][Stage 26:============================================>         (163 + 8) / 200][Stage 26:=============================================>        (167 + 8) / 200][Stage 26:=============================================>        (170 + 8) / 200][Stage 26:==============================================>       (173 + 8) / 200][Stage 26:===============================================>      (176 + 8) / 200][Stage 26:================================================>     (179 + 8) / 200][Stage 26:================================================>     (181 + 8) / 200][Stage 26:==================================================>   (186 + 8) / 200][Stage 26:==================================================>   (187 + 8) / 200][Stage 26:===================================================>  (190 + 8) / 200][Stage 26:====================================================> (196 + 4) / 200][Stage 26:=====================================================>(199 + 1) / 200]                                                                                [Stage 27:>                                                         (0 + 1) / 1][Stage 27:>                                                         (0 + 1) / 1][Stage 27:>                                                         (0 + 1) / 1][Stage 27:>                                                         (0 + 1) / 1][Stage 27:>                                                         (0 + 1) / 1][Stage 27:>                                                         (0 + 1) / 1][Stage 27:>                                                         (0 + 1) / 1][Stage 27:>                                                         (0 + 1) / 1][Stage 29:=>                                                      (6 + 9) / 200][Stage 29:==>                                                     (9 + 8) / 200][Stage 29:===>                                                   (12 + 8) / 200][Stage 29:====>                                                  (15 + 8) / 200][Stage 29:=====>                                                 (19 + 8) / 200][Stage 29:=====>                                                 (21 + 8) / 200][Stage 29:======>                                                (25 + 8) / 200][Stage 29:=======>                                               (28 + 8) / 200][Stage 29:========>                                              (30 + 8) / 200][Stage 29:=========>                                             (34 + 8) / 200][Stage 29:==========>                                            (37 + 9) / 200][Stage 29:===========>                                           (41 + 8) / 200][Stage 29:============>                                          (44 + 8) / 200][Stage 29:=============>                                         (49 + 8) / 200][Stage 29:==============>                                        (53 + 8) / 200][Stage 29:===============>                                       (56 + 8) / 200][Stage 29:===============>                                       (58 + 8) / 200][Stage 29:=================>                                     (62 + 8) / 200][Stage 29:=================>                                     (64 + 8) / 200][Stage 29:==================>                                    (67 + 8) / 200][Stage 29:==================>                                    (69 + 8) / 200][Stage 29:====================>                                  (74 + 8) / 200][Stage 29:====================>                                  (75 + 8) / 200][Stage 29:=====================>                                 (77 + 8) / 200][Stage 29:======================>                                (82 + 8) / 200][Stage 29:======================>                                (83 + 9) / 200][Stage 29:========================>                              (88 + 8) / 200][Stage 29:=========================>                             (91 + 8) / 200][Stage 29:==========================>                            (96 + 8) / 200][Stage 29:===========================>                          (100 + 9) / 200][Stage 29:===========================>                          (103 + 8) / 200][Stage 29:============================>                         (107 + 8) / 200][Stage 29:=============================>                        (110 + 8) / 200][Stage 29:===============================>                      (115 + 8) / 200][Stage 29:===============================>                      (117 + 9) / 200][Stage 29:================================>                     (121 + 8) / 200][Stage 29:==================================>                   (126 + 8) / 200][Stage 29:==================================>                   (129 + 8) / 200][Stage 29:===================================>                  (133 + 8) / 200][Stage 29:====================================>                 (137 + 8) / 200][Stage 29:=====================================>                (140 + 8) / 200][Stage 29:======================================>               (142 + 8) / 200][Stage 29:=======================================>              (146 + 8) / 200][Stage 29:=======================================>              (148 + 8) / 200][Stage 29:========================================>             (149 + 8) / 200][Stage 29:=========================================>            (152 + 8) / 200][Stage 29:=========================================>            (155 + 8) / 200][Stage 29:==========================================>           (158 + 8) / 200][Stage 29:===========================================>          (161 + 8) / 200][Stage 29:============================================>         (164 + 8) / 200][Stage 29:============================================>         (165 + 8) / 200][Stage 29:=============================================>        (169 + 8) / 200][Stage 29:==============================================>       (172 + 8) / 200][Stage 29:==============================================>       (174 + 8) / 200][Stage 29:===============================================>      (177 + 8) / 200][Stage 29:================================================>     (179 + 8) / 200][Stage 29:================================================>     (180 + 8) / 200][Stage 29:=================================================>    (183 + 8) / 200][Stage 29:=================================================>    (185 + 8) / 200][Stage 29:==================================================>   (188 + 8) / 200][Stage 29:===================================================>  (189 + 8) / 200][Stage 29:===================================================>  (192 + 8) / 200][Stage 29:====================================================> (196 + 4) / 200]                                                                                ----------------------------------------
Exception happened during processing of request from ('127.0.0.1', 37680)
Traceback (most recent call last):
  File "/usr/lib64/python3.6/socketserver.py", line 320, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib64/python3.6/socketserver.py", line 351, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib64/python3.6/socketserver.py", line 364, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib64/python3.6/socketserver.py", line 724, in __init__
    self.handle()
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/pyspark/accumulators.py", line 262, in handle
    poll(accum_updates)
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/pyspark/accumulators.py", line 235, in poll
    if func():
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/pyspark/accumulators.py", line 239, in accum_updates
    num_updates = read_int(self.rfile)
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/pyspark/serializers.py", line 564, in read_int
    raise EOFError
EOFError
----------------------------------------
ERROR:root:Exception while sending command.
Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1207, in send_command
    raise Py4JNetworkError("Answer from Java side is empty")
py4j.protocol.Py4JNetworkError: Answer from Java side is empty

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1033, in send_command
    response = connection.send_command(command)
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1212, in send_command
    "Error while receiving", e, proto.ERROR_ON_RECEIVE)
py4j.protocol.Py4JNetworkError: Error while receiving
ERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:36881)
Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [Errno 111] Connection refused
generate_dates: right_date: iteration: 0 20210509
generate_dates: left_date: iteration: 0 20210503
generate_dates: right_date: iteration: 1 20210502
generate_dates: left_date: iteration: 1 20210426
generate_dates: right_date: iteration: 2 20210425
generate_dates: left_date: iteration: 2 20210419
generate_dates: right_date: iteration: 3 20210418
generate_dates: left_date: iteration: 3 20210412
generate_dates: right_date: iteration: 4 20210411
generate_dates: left_date: iteration: 4 20210405
generate_dates: right_date: iteration: 5 20210404
generate_dates: left_date: iteration: 5 20210329
generate_dates: right_date: iteration: 6 20210328
generate_dates: left_date: iteration: 6 20210322
generate_dates: right_date: iteration: 7 20210321
generate_dates: left_date: iteration: 7 20210315
generate_dates: right_date: iteration: 8 20210314
generate_dates: left_date: iteration: 8 20210308
generate_dates: right_date: iteration: 9 20210307
generate_dates: left_date: iteration: 9 20210301
generate_dates: right_date: iteration: 10 20210228
generate_dates: left_date: iteration: 10 20210222
generate_dates: right_date: iteration: 11 20210221
generate_dates: left_date: iteration: 11 20210215
generate_dates: right_date: iteration: 12 20210214
generate_dates: left_date: iteration: 12 20210208
generate_dates: right_date: iteration: 13 20210207
generate_dates: left_date: iteration: 13 20210201
generate_dates: right_date: iteration: 14 20210131
generate_dates: left_date: iteration: 14 20210125
generate_dates: right_date: iteration: 15 20210124
generate_dates: left_date: iteration: 15 20210118
generate_dates: right_date: iteration: 16 20210117
generate_dates: left_date: iteration: 16 20210111
generate_dates: right_date: iteration: 17 20210110
generate_dates: left_date: iteration: 17 20210104
generate_dates: right_date: iteration: 18 20210103
generate_dates: left_date: iteration: 18 20201228
generate_dates: right_date: iteration: 19 20201227
generate_dates: left_date: iteration: 19 20201221
generate_dates: right_date: iteration: 20 20201220
generate_dates: left_date: iteration: 20 20201214
generate_dates: right_date: iteration: 21 20201213
generate_dates: left_date: iteration: 21 20201207
generate_dates: right_date: iteration: 22 20201206
generate_dates: left_date: iteration: 22 20201130
generate_dates: right_date: iteration: 23 20201129
generate_dates: left_date: iteration: 23 20201123
generate_dates: right_date: iteration: 24 20201122
generate_dates: left_date: iteration: 24 20201116
generate_dates: right_date: iteration: 25 20201115
generate_dates: left_date: iteration: 25 20201109
Starting SCP of local file activity_data_transactions_20210503_to_20210509_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210503_to_20210509_results.csv
Finished writing remote file in 0:05:17.530478, transfer rate 0.48184983304972695 MB/s
file : activity_data_transactions_20210503_to_20210509_results.csv has been copied to OBA!
file : activity_data_transactions_20210503_to_20210509_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210426_to_20210502_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210426_to_20210502_results.csv
Finished writing remote file in 0:01:50.687800, transfer rate 1.3831184456699386 MB/s
file : activity_data_transactions_20210426_to_20210502_results.csv has been copied to OBA!
file : activity_data_transactions_20210426_to_20210502_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210419_to_20210425_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210419_to_20210425_results.csv
Finished writing remote file in 0:05:09.607406, transfer rate 0.4935228932263897 MB/s
file : activity_data_transactions_20210419_to_20210425_results.csv has been copied to OBA!
file : activity_data_transactions_20210419_to_20210425_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210412_to_20210418_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210412_to_20210418_results.csv
Finished writing remote file in 0:01:16.687963, transfer rate 1.9964241222413226 MB/s
file : activity_data_transactions_20210412_to_20210418_results.csv has been copied to OBA!
file : activity_data_transactions_20210412_to_20210418_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210405_to_20210411_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210405_to_20210411_results.csv
Finished writing remote file in 0:01:37.639440, transfer rate 1.5710472912828566 MB/s
file : activity_data_transactions_20210405_to_20210411_results.csv has been copied to OBA!
file : activity_data_transactions_20210405_to_20210411_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210329_to_20210404_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210329_to_20210404_results.csv
Finished writing remote file in 0:01:16.921498, transfer rate 1.9979172670623238 MB/s
file : activity_data_transactions_20210329_to_20210404_results.csv has been copied to OBA!
file : activity_data_transactions_20210329_to_20210404_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210322_to_20210328_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210322_to_20210328_results.csv
Finished writing remote file in 0:01:16.364587, transfer rate 2.0023646690652894 MB/s
file : activity_data_transactions_20210322_to_20210328_results.csv has been copied to OBA!
file : activity_data_transactions_20210322_to_20210328_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210315_to_20210321_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210315_to_20210321_results.csv
Finished writing remote file in 0:04:59.302209, transfer rate 0.5123092396199956 MB/s
file : activity_data_transactions_20210315_to_20210321_results.csv has been copied to OBA!
file : activity_data_transactions_20210315_to_20210321_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210308_to_20210314_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210308_to_20210314_results.csv
Finished writing remote file in 0:01:18.075130, transfer rate 1.962655796350419 MB/s
file : activity_data_transactions_20210308_to_20210314_results.csv has been copied to OBA!
file : activity_data_transactions_20210308_to_20210314_results.csv has been removed!
Starting SCP of local file activity_data_transactions_20210301_to_20210307_results.csv to remote 172.16.101.205:/home/davidtia/incoming/recurrence/activitydata/activity_data_transactions_20210301_to_20210307_results.csv
Finished writing remote file in 0:01:48.350727, transfer rate 1.4147440910225733 MB/s
file : activity_data_transactions_20210301_to_20210307_results.csv has been copied to OBA!
file : activity_data_transactions_20210301_to_20210307_results.csv has been removed!
Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [Errno 111] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "extract_and_deliver_to_oba_activity_data_hist.py", line 121, in <module>
    main()
  File "extract_and_deliver_to_oba_activity_data_hist.py", line 115, in main
    extract_and_copyfile(args, spark, td_driver, td_url, td_user, td_password, sdate, edate, prefix)
  File "extract_and_deliver_to_oba_activity_data_hist.py", line 37, in extract_and_copyfile
    extract_activity_data(spark, td_driver, td_url, td_user, td_password, start_date, end_date, filename)
  File "extract_and_deliver_to_oba_activity_data_hist.py", line 18, in extract_activity_data
    td_process = ExtractorSQL(spark, False, td_driver, td_url, td_user, td_password)
  File "/home/patrice.nzi/backup/oba/airflow_prod/dags/backend/utils/extractor.py", line 12, in __init__
    self.df = spark.createDataFrame([], schema)
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/pyspark/sql/session.py", line 656, in createDataFrame
    self._jvm.SparkSession.setActiveSession(self._jsparkSession)
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1695, in __getattr__
    "\n" + proto.END_COMMAND_PART)
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1031, in send_command
    connection = self._get_connection()
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 979, in _get_connection
    connection = self._create_connection()
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 985, in _create_connection
    connection.start()
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1127, in start
    raise Py4JNetworkError(msg, e)
py4j.protocol.Py4JNetworkError: An error occurred while trying to connect to the Java server (127.0.0.1:36881)
ERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:36881)
Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [Errno 111] Connection refused
ERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:36881)
Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [Errno 111] Connection refused
ERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:36881)
Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [Errno 111] Connection refused
ERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:36881)
Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 977, in _get_connection
    connection = self.deque.pop()
IndexError: pop from an empty deque

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/patrice.nzi/backup/oba/obavenv/lib/python3.6/site-packages/py4j/java_gateway.py", line 1115, in start
    self.socket.connect((self.address, self.port))
ConnectionRefusedError: [Errno 111] Connection refused
